---
const testimonials = [
  {
    avatar: 'https://tailkits.com/ui/iframe/assets/img/avatar-1.png',
    quote: 'This extension has saved us hours every week. We manage 5 Shopify stores in different languages, and the one-click translation is a game changer. No more copying and pasting!',
    author: 'Sarah Mitchell',
    role: 'E-commerce Manager',
    logo: 'https://tailkits.com/ui/iframe/assets/img/logo-big.svg'
  },
  {
    avatar: 'https://tailkits.com/ui/iframe/assets/img/avatar-1.png',
    quote: 'The translation quality is impressive. We expanded to 3 new European markets in half the time it would normally take. The AI assistant helps us maintain consistent brand voice across all languages.',
    author: 'Marcus Weber',
    role: 'Store Owner',
    logo: 'https://tailkits.com/ui/iframe/assets/img/logo-big.svg'
  },
  {
    avatar: 'https://tailkits.com/ui/iframe/assets/img/avatar-1.png',
    quote: 'As a Shopify agency managing multiple client stores, this tool has become essential. The unlimited store support means we can use it across all our projects. Best investment we made this year!',
    author: 'Jennifer Liu',
    role: 'Agency Director',
    logo: 'https://tailkits.com/ui/iframe/assets/img/logo-big.svg'
  }
];
---

<section
  class="py-16 lg:py-24 bg-gradient-to-b from-[#E9FFFE] via-[#F6FFE7] to-white"
>
  <div class="max-w-7xl mx-auto px-4 xl:px-0 relative">
    <div class="testimonial-slider">
      {testimonials.map((testimonial, index) => (
        <figure
          class={`testimonial-slide flex-col items-center gap-y-6 sm:mx-auto sm:w-2/3 xl:w-1/2 xl:gap-y-9 ${index === 0 ? 'flex' : 'hidden'}`}
          data-index={index}
        >
          <img
            class="h-12 w-12 shrink-0 rounded-full object-cover md:h-16 md:w-16"
            src={testimonial.avatar}
            alt={testimonial.author}
          />
          <blockquote class="flex flex-col items-center">
            <p
              class="text-center font-medium text-neutral-700 md:text-lg xl:text-xl"
            >
              "{testimonial.quote}"
            </p>
            <div
              class="mt-6 flex flex-wrap items-center justify-center gap-4 xl:mt-9"
            >
              <figcaption class="font-medium text-slate-700">
                {testimonial.author}
              </figcaption>
              <div
                class="items-center justify-center rounded-full text-sm font-medium whitespace-nowrap shadow-[0_2px_10px_0px_rgba(0,0,0,0.15)] inline-flex bg-slate-300 text-slate-700 px-2 py-0.5"
              >
                {testimonial.role}
              </div>
            </div>
            <img class="mt-6 h-8 xl:mt-9" src={testimonial.logo} alt="Company Logo" />
          </blockquote>
        </figure>
      ))}
    </div>

    <div class="mt-6 flex items-center justify-center gap-x-2 md:mt-9">
      {testimonials.map((_, index) => (
        <button
          class={`testimonial-indicator h-2 w-2 shrink-0 rounded-full transition ${index === 0 ? 'bg-slate-900' : 'bg-neutral-300 hover:bg-neutral-200 cursor-pointer'}`}
          type="button"
          data-index={index}
          aria-label={`Go to testimonial ${index + 1}`}
        ></button>
      ))}
    </div>
  </div>
</section>

<script>
  function initTestimonialSlider() {
    const slides = document.querySelectorAll('.testimonial-slide');
    const indicators = document.querySelectorAll('.testimonial-indicator');
    let currentSlide = 0;

    function showSlide(index: number) {
      // Hide all slides
      slides.forEach((slide) => {
        slide.classList.add('hidden');
        slide.classList.remove('flex');
      });

      // Show current slide
      if (slides[index]) {
        slides[index].classList.remove('hidden');
        slides[index].classList.add('flex');
      }

      // Update indicators
      indicators.forEach((indicator, i) => {
        if (i === index) {
          indicator.classList.remove('bg-neutral-300', 'hover:bg-neutral-200', 'cursor-pointer');
          indicator.classList.add('bg-slate-900');
        } else {
          indicator.classList.remove('bg-slate-900');
          indicator.classList.add('bg-neutral-300', 'hover:bg-neutral-200', 'cursor-pointer');
        }
      });

      currentSlide = index;
    }

    // Add click handlers to indicators
    indicators.forEach((indicator, index) => {
      indicator.addEventListener('click', () => {
        showSlide(index);
      });
    });

    // Auto-rotate every 5 seconds
    setInterval(() => {
      const nextSlide = (currentSlide + 1) % slides.length;
      showSlide(nextSlide);
    }, 5000);
  }

  // Initialize on page load
  document.addEventListener('DOMContentLoaded', initTestimonialSlider);

  // Re-initialize after page transitions (for SPAs)
  document.addEventListener('astro:page-load', initTestimonialSlider);
</script>
